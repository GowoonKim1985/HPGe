#include <iostream>
#include "TMath.h"
#include "TMinuit.h"


void draw_run650_ch_check() {

  int ich = 1;

  double respa[14][3]={
{0.363128,	0.000667908,	-8.40E-08},
{0.370658,	0.000637953,	-7.62E-08},
{0.445986,	0.000680498,	-9.62E-08},
{1.99356,	0.00228603,	-9.97E-07},
{0.436251,	0.000626869,	-7.70E-08},
{0.402777,	0.000545669,	-4.38E-08},
{0.582696,	0.000821223,	-1.54E-07},
{0.495129,	0.000449309,	8.03E-09},
{0.511883,	0.000459608,	-2.06E-08},
{0, 0, 0},
{0.482192,	0.000504369,	-2.71E-08},
{0.432383,	0.000486415,	-3.44E-08},
{0.429384,	0.000619621,	-8.22E-08},
{0.448204,	0.000548424,	-4.75E-08}
  };

  TF1 *res[14];
  for(int i=0; i<14; i++){
    res[i] = new TF1(Form("res%i",i+1), "sqrt([0]*[0]+[1]*x+[2]*x*x)", 500, 1800);
    res[i]->SetParameters(respa[i][0], respa[i][1], respa[i][2]);
    res[i]->SetLineColor(kRed);
  }

  // 점 데이터
  const int dp=3;
  /*
  //old cal set
  double x[dp] = {6.09126e+02, 7.67416e+02,  9.11054e+02, 1.12001e+03};
  double ex[dp] = {2.18868e-02, 1.79930e-01, 9.11295e-02, 5.09417e-02};
  double y[dp] = { 8.52464e-01 ,   2.67469e+00, 1.02395e+00, 9.33861e-01};
  double ey[dp] = {2.35830e-02,2.91398e-01,  1.19865e-01, 5.67681e-02};
  */
  //new cal set v1

  double mean[14][dp]={
    {609.41447,	911.17509,	1120.4931},
    {0, 0, 0},
    {609.46585,	911.01466,	1120.4905},
    {0, 0, 0},
    {609.34123,	908.60219,	1120.3862},
    {609.35967,	911.51356,	1120.3493},
    {609.38401,	911.09095,	1120.4077},	
    {609.41378,	911.21135,	1120.2037},
    {609.48849,	911.21729,	1120.538},	
    {0, 0, 0},
    {609.36697,	911.06415,	1120.0978},
    {609.3084,	907.3171,	1120.6089},	
    {609.57845,	911.37864,	1120.68	},
    {609.43362,	911.92175,	1120.3717}
  };

  double mean_er[14][dp]={
    {0.0368944,	0.184184,	0.1334867},
    {0, 0, 0},
    {0.0376944,	1.8434492,	0.0998055},
    {0, 0, 0},
    {0.0405448,	0.711717,	0.1031085},	
    {0.035207,	0.1760269,	0.0877636},	
    {0.0366856,	0.5440986,	0.1051978},	
    {0.0361263,	0.1545888,	0.0963425},	
    {0.0356307,	0.163481,	0.1277513},
    {0, 0, 0},
    {0.0419192,	0.2475818,	0.0849398},	
    {0.0400935,	0.4399385,	0.1679975},	
    {0.0422615,	0.1722439,	0.1119306},	
    {0.0330191,	0.2512967,	0.0983162}
  };

  double sigma[14][dp]={
{0.5882025,	0.4433509,	0.8751181},	
{0, 0, 0},
{0.6477089,	1.0732617,	0.5073429},	
{0, 0, 0},
{0.6559058,	1.1343259,	0.7244103},	
{0.6119516,	0.3946476,	0.6523708},	
{0.6903908,	0.803169,	0.7269758},	
{0.6012956,	0.4658982,	0.6679179},	
{0.6347671,	0.5147643,	0.7939436},	
{0, 0, 0},
{0.6370167,	0.4860735,	0.6194651},	
{0.6036931,	0.5774723,	0.8401357},	
{0.6556927,	0.4960506,	0.639558},	
{0.5764584,	0.406534,	0.5732635}
  };

  double sigma_er[14][dp]={
    {0.0311275,	0.1122561,	0.1085395},	
    {0, 0, 0},
    {0.0302927,	0.5485,	0.0741274},
    {0, 0, 0},
    {0.0341726,	0.7146959,	0.0959453},
    {0.0275123,	0.4933022,	0.0664595},	
    {0.0279175,	0.3317766,	0.0947215},	
    {0.0291169,	0.1341942,	0.0917637},	
    {0.033272,	0.147576,	0.0983436},
    {0, 0, 0},
    {0.0333312,	0.1935213,	0.0746268},	
    {0.0321812,	0.480841,	0.1524774},	
    {0.0376027,	0.125722,	0.0989612},	
    {0.0282633,	0.5420448,	0.0825991},
  };

  TCanvas *c[14];
  for(int i=0; i<14; i++){
    c[i] = new TCanvas(Form("ch%i",i+1), Form("ch%i",i+1), 800, 600);
  }
  for(int ich=1; ich<15; ich++){
    if(ich!=2||ich!=4||ich!=10){

      double x[dp] = {mean[ich-1][0], mean[ich-1][1], mean[ich-1][2]};//mean
      double ex[dp] = {mean_er[ich-1][0], mean_er[ich-1][1], mean_er[ich-1][2]};
      double y[dp] = {sigma[ich-1][0], sigma[ich-1][1], sigma[ich-1][2]};//sigma
      double ey[dp] = {sigma_er[ich-1][0], sigma_er[ich-1][1], sigma_er[ich-1][2]};
  
      c[ich-1]->cd();
      TGraphErrors *points = new TGraphErrors(dp, x, y, ex, ey);
      points->GetXaxis()->SetTitle("Energy[keV]");
      points->GetYaxis()->SetTitle("Sigma[keV]");

      points->SetMarkerStyle(21); 
      points->SetMarkerSize(1.5);
      //     points->SetMinimum(0.5);
            points->SetMaximum(2.5);
  //  points->SetMarkerColor(kRed);

  // 캔버스

      points->Draw("AP"); // P = point  
  res[ich-1]->Draw("SAME");


  c[ich-1]->Modified();
  c[ich-1]->Update();

    } 
  }
}
